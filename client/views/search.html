<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<script type="text/javascript" src="../public/js/jquery-3.1.1.min.js"></script>
<script type="text/javascript" src="../public/js/materialize.min.js"></script>
<link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet">
<link type="text/css" rel="stylesheet" href="../public/css/materialize.min.css"  media="screen,projection"/>
<link href='../public/css/master.css' rel='stylesheet' type='text/css' />

<script type="text/javascript">
$(document).keyup(function(e) {
	if (e.keyCode == 27)
		closePopUp();
});

function tag(title)
{
	this.title = title;
	this.selected = false;
}

var tags = ["tandtråd", "tandtroll", "tandvärk", "tandsten", "tandpetare", "tandkött", "herpes", "tandlös", "blomkål", "tandkossa", "kossan säger mu", "karies", "baktus"];
var tagObjects = [];
var currentAutoSearchPos = 0;

for (var i = 0; i < tags.length; i++)
{
	tagObjects.push(new tag(tags[i]));
}
function displayTagList(string)
{
	currentAutoSearchPos = 0;
	string = string.toLowerCase();
	if(string.length > 1)
	{
		$("#auto-search-results").html("");
		for(var i=0; i<tagObjects.length; i++)
		{
			if(tagObjects[i].title.includes(string) && !tagObjects[i].selected)
				$("#auto-search-results").append("<span id='sugg" + i + "'>" + tagObjects[i].title + "</span>");
		}
		$("#auto-search-results").find("span").click(function(event) {
			selectTag(listIdToTagId(event));
		});
		$("#auto-search-results").css("display", "block");
		$("#auto-search-results").find("span").mouseover(function(event) {
			currentAutoSearchPos = listIdToTagId(event);
			markAutoSearch();
		});
	}
	else
		$("#auto-search-results").hide();
}
function markAutoSearch()
{
	var results = $("#auto-search-results").find("span");
	for(var i=0; i<results.length; i++)
		$(results[i]).css("background-color", "transparent");
	$(results[currentAutoSearchPos]).css("background-color", "#eeeeee");
}

function listIdToTagId(event)
{
	var results = $("#auto-search-results").find("span");
	for(var i=0; i<results.length; i++)
	{
		if($(results[i]).html() == $(event.target).html())
			break;
	}
	return i;
}

function selectTag(selectedTagId)
{
	var results = $("#auto-search-results").find("span");
	thisTagId = $(results[selectedTagId]).attr("id").substring(4, $(results[selectedTagId]).attr("id").length);
	tagObjects[thisTagId].selected = true;
	$("#selected-tags").append("<div class='chip'>" + tagObjects[thisTagId].title + "<i id='tag" + thisTagId + "' class='removeTag close material-icons'>close</i></div>");
	$("#search-input").val("");
	$("#auto-search-results").hide();
	$("#search-input").focus();
}

$("html").click(function(event) {
	if(event.target.id != "search-input")
		$("#auto-search-results").hide();
});

$(document).on("click", ".removeTag", function(){
	$(this).parent().remove();
	tagObjects[$(this).attr("id").substring(3, $(this).attr("id").length)].selected = false;
});

var advancedBar = false;
function showAdvancedBar()
{
	if(advancedBar)
		$("#advanced-bar").css("margin-top", "-45px");
	else
		$("#advanced-bar").css("margin-top", "0px");
	advancedBar = !advancedBar;
}

function closePopUp()
{
	$("#black-back").hide();
	$("#popup-image-wrapper").hide();
}
</script>
<title>MedImager</title>
</head>

<body>

<div id="black-back"></div>
<div id="popup-image-wrapper">
	<div id="popup-image-container">
		<img src="http://cdn.modernfarmer.com/wp-content/uploads/2014/09/innercowhero.jpg" id="popup-image">
	</div>
	<div id="popup-image-data">
		<i id="popup-close-button" class='small material-icons'>close</i>
		<label>Bild-ID</label>
		<p>Bild12345678</p>
		<label>Instutition</label>	
		<p>Chalmerska oralinstutitionen</p>
		<label>Fotodatum</label>
		<p>25 januari 1996</p>
		<label>Favoritfilm</label>
		<p>Lejonkungen</p><label>Favoritfilm</label>
		<p>Lejonkungen</p><label>Favoritfilm</label>
		<p>Lejonkungen</p><label>Favoritfilm</label>
		<p>Lejonkungen</p><label>Favoritfilm</label>
		<p>Lejonkungen</p><label>Favoritfilm</label>
		<p>Lejonkungen</p>
		<label>Andra kommentarer</label>
		<p>Han är ful i munnen.</p><label>Andra kommentarer</label>
		<p>Han är ful i munnen.</p><label>Andra kommentarer</label>
		<p>Han är ful i munnen.</p><label>Andra kommentarer</label>
		<p>Han är ful i munnen.</p><label>Andra kommentarer</label>
		<p>Han är ful i munnen.</p><label>Andra kommentarer</label>
		<p>Han är ful i munnen.</p>
		
		<div id="popup-image-data-buttons">
			<div>Bramarkera</div><div>Permalänk</div>
		</div>
	</div>
</div>

<div id="menu-wrapper">
	<div id="menu-bar">
		<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/EBay_logo.svg/2000px-EBay_logo.svg.png" class="medimager-logo">
		<div id="search-wrapper">
			<input id="search-input">
			<div id="auto-search-results">Sökresultat</div>
			<div id="selected-tags"></div>
		</div>
		<span id="advanced-button" onclick="showAdvancedBar();">Avancerad sökning</span>
		<i class='user-button medium material-icons'>account_circle</i>
	</div>
	<div id="advanced-bar">
		<input type="checkbox" id="rokare-check"><label for="rokare-check">Rökare</label>
		<input type="checkbox" id="snusare-check"><label for="snusare-check">Snusare</label>
		<input type="checkbox" id="alder-check"><label for="alder-check">Hög ålder</label>
	</div>
</div>

<div id="page-wrapper">

<ul id="slide-out" class="side-nav">

</ul>
<a href="#" data-activates="slide-out" class="button-collapse" id="collections-togglebutton"><span>></span></a>

	<p id="results-count">99 999 resultat</p>
	
	<div id="search-results">
		<span style="background-image: url('http://cdn.modernfarmer.com/wp-content/uploads/2014/09/innercowhero.jpg');"></span>
		<span style="background-image: url('http://cdn.modernfarmer.com/wp-content/uploads/2014/09/innercowhero.jpg');"></span>
		<span style="background-image: url('http://cdn.modernfarmer.com/wp-content/uploads/2014/09/innercowhero.jpg');"></span>
		<span style="background-image: url('https://petterssonorg.files.wordpress.com/2013/08/surikat.jpg');"></span>
		<span style="background-image: url('http://4.bp.blogspot.com/-b_CoEyL7Y4E/VeCTOqEqdwI/AAAAAAAAJ1A/0kigqVeRPnM/s1600/TrumpPhenomenon2.jpg');"></span>
		<span style="background-image: url('http://www.pets4homes.co.uk/images/articles/1646/large/kitten-emergencies-signs-to-look-out-for-537479947ec1c.jpg');"></span>
		<span style="background-image: url('http://www.pets4homes.co.uk/images/articles/1646/large/kitten-emergencies-signs-to-look-out-for-537479947ec1c.jpg');"></span>
		<span style="background-image: url('https://s-media-cache-ak0.pinimg.com/originals/91/d9/7e/91d97e06cdc41757cfb421dab4eabd30.jpg');"></span>
		<span style="background-image: url('http://wallpapersboom.net/wp-content/uploads/2015/04/2303_timon_and_pumbaa.jpg');"></span>
		<span style="background-image: url('https://s-media-cache-ak0.pinimg.com/originals/91/d9/7e/91d97e06cdc41757cfb421dab4eabd30.jpg');"></span>
		<span style="background-image: url('https://s-media-cache-ak0.pinimg.com/originals/91/d9/7e/91d97e06cdc41757cfb421dab4eabd30.jpg');"></span>
		<span style="background-image: url('http://www.konbini.com/en/files/2016/09/cow-triangle.jpg');"></span>
		<span style="background-image: url('http://cdn.modernfarmer.com/wp-content/uploads/2014/09/innercowhero.jpg');"></span>
		<span style="background-image: url('http://i2.irishmirror.ie/incoming/article5979450.ece/ALTERNATES/s1200/Blosom-Tallest-Cow.jpg');"></span>
		<span style="background-image: url('http://i2.irishmirror.ie/incoming/article5979450.ece/ALTERNATES/s1200/Blosom-Tallest-Cow.jpg');"></span>
		<span style="background-image: url('http://i2.irishmirror.ie/incoming/article5979450.ece/ALTERNATES/s1200/Blosom-Tallest-Cow.jpg');"></span>
		<span style="background-image: url('http://i2.irishmirror.ie/incoming/article5979450.ece/ALTERNATES/s1200/Blosom-Tallest-Cow.jpg');"></span>
		<span style="background-image: url('http://i2.irishmirror.ie/incoming/article5979450.ece/ALTERNATES/s1200/Blosom-Tallest-Cow.jpg');"></span>
	</div>
</div>
<div id="footer">
© MedImager, 2017. Alla rättigheter reserverade.
</div>

<script>

$("#search-results span").click(function(event) {
	var url = event.target.style.backgroundImage;
	$("#popup-image").attr("src", url.substring(5, url.length-2));
	$("#popup-image-wrapper").css("display", "flex");
	$("#black-back").css("display", "block");
});
$("#black-back").click(function(event) {
	closePopUp();
});
$("#popup-close-button").click(function(event) {
	closePopUp();
});
$('#search-input').click(function() {
	displayTagList($(this).val());
});
$('#search-input').keydown(function(event) {
	if(event.keyCode == 40)
		currentAutoSearchPos++;
	else if(event.keyCode == 38)
		currentAutoSearchPos--;
	else if(event.keyCode == 13)
		selectTag(currentAutoSearchPos);
	else
		displayTagList($(this).val());
	
	if(currentAutoSearchPos < 0)
		currentAutoSearchPos = $("#auto-search-results").find("span").length-1;
	else if(currentAutoSearchPos > $("#auto-search-results").find("span").length-1)
		currentAutoSearchPos = 0;
	markAutoSearch();
});
$(".button-collapse").sideNav();
</script>
</body>
</html>